- 본 프로젝트는 제로베이스 데이터 취업 스쿨 과정의 일환으로 진행되었습니다.
- 본 리드미 문서는 머신러닝 프로젝트 최종 발표 내용을 기반으로 작성되었습니다.
- 팀원 : 이솔, 심소민, 정현봉 (팀원별 역할 구분 없이 전과정 함께 진행함)

# '시니어 활동, 수면 라이프로그 데이터 기반 치매 고위험군 예측' 
## 프로젝트 개요
### 프로젝트 배경 및 필요성
![Image](https://github.com/user-attachments/assets/b9db6cbf-5491-47c5-aa1e-f0328f12a2b6)
- 우리나라는 매우 빠르게 고령화가 진행중이며, 2024년 말 기준으로 초고령사회에 진입했다.
- 고령화와 더불어 치매 환자의 수 또한 빠르게 증가하고 있다.
- 현재 노인 인구의 10% 이상이 치매이며, 2050년에는 300만 명에 달할 것으로 추정하고 있다.

![Image](https://github.com/user-attachments/assets/6f0939ae-ce47-462a-b5f8-6ceece5f98a3)
- 치매는 조기 발견 및 치료가 매우 중요하다.
- 치매가 악화되기 전에 미리 발견하면 3~40% 확률로 예방이 가능하고, 50%는 중증화가 지연되며, 20%는 완치까지 가능하다.
- 치매 조기 발견을 통해 치매로 인해 생겨날 사회적, 금전적 비용과 부담을 크게 줄일 수 있다. 

![Image](https://github.com/user-attachments/assets/04b46a20-dcd7-416e-9ecb-35f3237b27ce)
- 치매의 초기 단계는 경도인지장애(MCI)라 한다.
- 치매가 악화되기 전에 이 단계에서 발병을 확인하는 것이 중요하다.
- 경도인지장애 환자는 인지기능이 약간 떨어지기는 하지만, 일상생활에는 문제가 없기 때문에 중증 치매로 악화되기 전에 확인하기 어렵다.
- 경도인지장애를 알아채기 어렵기 때문에, 병원에서 검사하는 것과 더불어 일상적으로 검사를 진행할 수 있다면 좋을 것이다.

### 프로젝트 목표
![Image](https://github.com/user-attachments/assets/cfcb7286-ee59-4374-b77a-6edb56c8ca10)
- 프로젝트의 목표는 오우라링 데이터를 이용하여 55세 이상 정상/경도인지장애/중증치매 그룹으로 분류하는 모델을 개발한다.
- 오우라링은 웨어러블 전자기기로, 착용자의 심박동수, 움직임, 호흡 등을 실시간으로 측정한다.
- 이를 기반으로 착용자의 활동과 수면에 대한 다양한 데이터를 제공한다. 

### 데이터 소개
![Image](https://github.com/user-attachments/assets/96516a44-1fb6-4a17-80a6-3d1b99fbd7af)
- 훈련용 데이터는 약 9000개 행으로 이루어져있다. [데이터셋 링크](https://www.aihub.or.kr/aihubdata/data/view.do?currMenu=115&topMenu=100&aihubDataSe=data&dataSetSn=226)
- 각 행에는 각 참가자의 하루동안의 로그데이터가 기록되어 있다.
- 훈련용 데이터는 141명 참가자의 4달 간 기록이다.
- 그중 정상은 85명, 경증은 47명, 중증은 9명이다.
- 수면과 관련된 변수는 크게 수면 시간 정보(각 수면 단계의 시간 등), 수면 중 신체 반응 정보(뒤척임 정도, 피부 온도 등) 등이 있다.
- 활동과 관련된 변수는 MET로그, 활동 칼로리, 걸음수, 움직인 거리 등이 있다.
- 또 오우라 링 회사 측에서 하루 동안의 데이터를 기반으로 측정한 점수 변수들이 있다. 

## 데이터 분석
### EDA
![Image](https://github.com/user-attachments/assets/5852ee34-5274-4936-84fe-40c4b7b62210)
- EDA는 세 그룹(정상, MCI, 중증치매)간의 차이가 잘 드러나는 변수들을 중심으로 진행했다. 
- 하루 동안 시간별 평균 MET의 변화를 그룹별로 표시한 그래프이다.
- MET란 활동하지 않는 상태에서 섭취하는 산소의 양을 MET1로 하여 여러 활동의 강도를 나타내는 수치이다. 예를 들어 천천히 걷기는 MET2정도이다.
- 중증치매 환자 그룹의 경우 10~14시 동안 다른 두 그룹에 비해 활동량이 적다는 특징이 보인다.
- 연구에 의하면 치매가 진행됨에 따라 낮잠 시간이 늘어나기 때문에 중증 치매 환자의 활동량이 적은 것으로 보인다.
- 그러므로 그룹 간의 격차가 가장 큰 낮 시간을 중심으로 MET를 분석할 필요가 있다.

![Image](https://github.com/user-attachments/assets/15f7a4dc-c18c-4bc4-ba5e-cb589675bcb9)
- 활동 강도와 활동 빈도에 대한 오우라링 점수에서도 같은 양상을 확인할 수 있다.
- 오우라링 점수는 하루 동안의 활동량에 대해 평가한 것이지만, 중증 치매 그룹이 다른 그룹보다 '나쁨' 등급이 더 많다는 것을 확인할 수 있다. 

![Image](https://github.com/user-attachments/assets/95a99a8f-077c-41bc-bf03-6188baea9a50)
- 다음으로 시간에 따른 수면 단계의 변화를 그룹별로 비교한 그래프이다.
- 수면 단계는 깊은 수면 / 얕은 수면 / 램 수면 / 깨어있는 시간 으로 구분된다. (심박수, 호흡 등으로 수면 단계를 측정한다)
- 깊은 수면과 램 수면이 길고, 깨어있는 시간이 짧을수록 수면 점수가 좋다.
- 수면 직후 90분간 깊은 수면의 비율이 가장 높은데, 중증치매는 다른 두 그룹에 비해 깊은 수면의 비율이 낮고, 깨어있는 비율이 높다.

![Image](https://github.com/user-attachments/assets/e7f76ae7-6113-4e04-8ae7-77d5691add7d)
- 깊은 수면 점수와 수면 효율 점수를 보아도 중증 치매 그룹의 점수가 나쁘다.

![Image](https://github.com/user-attachments/assets/2c4dbfe1-750b-4cf8-9bde-2e644d782e21)
- 뒤척임 비율의 박스 플롯을 보면 중증 치매 그룹의 비율이 높은 편이다.
- 수면 방해 점수도 중증 치매 그룹의 등급이 나쁘다.
- 위와 같은 사항들을 고려해 보았을 때 중증 치매 그룹의 수면 질이 다른 그룹에 비해 더 나쁘다고 할 수 있다.

![Image](https://github.com/user-attachments/assets/2c251d2c-27f2-4e3b-9fd9-a77fd36a9e53)
- 한편 수면 시작 시간을 보면 치매 그룹이 좀 더 일찍 잠드는 편이다.
- 반면 수면 시간은 중증 치매 그룹이 더 많다.
- 즉 일찍 잠들고 많이 잔다는 것이다.
- 연구에 의하면 치매가 진행될수록 수면시간이 길어진다고 한다.

![Image](https://github.com/user-attachments/assets/b7f985b3-388f-4e52-92bd-01d443c4feaf)
- 기상 시간을 기준으로 다음과 같이 3그룹으로 나눠볼 수 있다.
- 중증 치매 그룹은 다른 그룹에 비해 아침형 인간이 적고, 중간형이 많다. 그리고 저녁형 인간의 비율이 10%정도 된다.
- 치매가 진행됨에 따라 아침형 인간이 줄어들고 저녁형 패턴이 증가하는 것으로 추정해 볼 수 있다.

### 데이터 전처리
#### '수면 중간점' 변수
- '수면 중간점'은 수면 시간 중 중간점이 언제인지를 가리키는 변수이다. 예를 들어 밤 9시부터 6시까지 잤다면 1시 반이 중간점이다.
- 자정을 기준으로 중간점이 자정 이전이면 음수, 자정 이후면 양수가 되도록 수정했다. 

#### '걸음 수' 변수 - '활동 칼로리' 변수
![Image](https://github.com/user-attachments/assets/30b249f6-82c3-4839-a0ae-36fd34d92c4c)
- 걸음 수가 많은데 비해 소비한 활동 칼로리가 매우 작은 경우가 있다.
- 이를 이상치로 판단하고 유사한 그룹의 평균값으로 대체했다.

#### 오우라링 점수 변수
- 9일 연속으로 오우라링 점수가 0으로 기록된 이용자가 1명 있다.
- 이를 이상치로 보고 선형 보간법으로 데이터를 보정했다.

### 피처 엔지니어링
#### 심소민
- 아침/낮/저녁/새벽의 평균 활동량 met, 하루 전체 활동량 met
- 아침~낮, 저녁~새벽의 활동량 비율
- 활동 유형 
- 평균 met, 비활동 시간, 하루 전체 활동량 met, 아침~낮의 활동량 비율, 저녁~새벽 활동량 비율
- 위 5개 변수는 시간적 맥락을 반영하기 위해 이전 날짜의 데이터와 일정 기간의 이동 평균을 변수로 추가했다.(2일 전, 3일 전, 3일 평균, 7일 평균, 30일 평균)
- 기상 시간에 따른 활동 유형, 기상시간 점수, 적정 수면시간과의 차이(초, 분), 수면시간(시)
- 사람별 평균 기상시간 / 기상시간 표준편차 / 평균 수면시간 / 수면시간 표준편차, 사람별 적정 수면시간과의 차이, 비정상적 기상 여부

#### 이솔
- 솔님 추가 부탁

#### 정현봉
- 실시간 로그 데이터 중 수치형인 met 로그, 심박동변동 로그, 심박동 로그를 분석했다.
- met는 10~14시, 심박동변동과 심박동은 최초 90분간의 각종 통계량을 구했다. (평균, 표준편차, 최댓값, 최솟값, 평균절대편차, 평균제곱근편차, 사분위수 범위, 엔트로피)
- 추가로 수면 시작 시간 / 10~14시 2이상 MET의 총합 / 최초 90분간 수면 4단계의 각 개수

## 모델링
### 모델 설계 및 학습

### 모델 성능 평가 및 비교
- feature_selection으로 해당 모델의 feature_importance가 낮은 변수를 제거했다. 


## 결론 
### 결과 및 해석

### 한계
#### 데이터 상의 문제점
1. 데이터의 각 행은 한 사람의 하루의 기록을 나타내고, 연구 대상인 사람은 140명 정도이다. ->
한 사람의 한두달 간에 생활 패턴이 거의 비슷하다고 볼 때, 실제로 학습할 수 있는 패턴은 140개 정도이다.
새로운 생활 패턴을 가지고 있는 사람을 예측하기 어려울 가능성이 높다.

2. 클래스별 데이터의 불균형이 매우 심하다.
-> 정상 그룹은 잘 학습할 수 있지만, 경증과 중증은 학습하기 어려울 가능성이 높다. 그러므로
이들 클래스에 속하는 새로운 사람의 데이터가 주어진다면 예측이 매우 어려울 것이다.

3. 사람별로 제공된 날짜 데이터의 개수가 다르다. 
-> 이는 날짜 데이터가 많은 사람을 많이 학습하고, 적은 사람은 적게 학습하는 결과가 나올 
확률이 크다. 

### 프로젝트 고도화 방안
